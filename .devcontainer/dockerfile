# FROM python:3.11-slim

# WORKDIR /app

# # Install system dependencies
# RUN apt-get update && apt-get install -y \
#     postgresql-client \
#     libpq-dev \
#     gcc \
#     python3-dev \
#     libjpeg-dev \
#     zlib1g-dev \
#     && rm -rf /var/lib/apt/lists/*

# # Copy requirements first
# COPY requirements.txt .
# RUN pip install --no-cache-dir -r requirements.txt

# # Copy project files
# COPY . .

# # Create directory for static files
# RUN mkdir -p kvitsapp/static/images

# # Set permissions
# RUN chmod -R 755 kvitsapp/static/images

# # Run server
# CMD ["python", "manage.py", "runserver", "0.0.0.0:8000"]

# .devcontainer/Dockerfile
FROM python:3.11-slim

# Set environment variables
ENV PYTHONDONTWRITEBYTECODE=1
ENV PYTHONUNBUFFERED=1

# Install necessary packages to manage users
RUN apt-get update && apt-get install -y --no-install-recommends adduser

# Add the vscode user with a specific UID (1000 is common) and group
RUN groupadd --gid 1000 vscode
RUN adduser --uid 1000 --gid vscode --shell /bin/bash --home /home/vscode vscode

# Set the working directory
WORKDIR /workspace

# Install dependencies
RUN apt-get install -y build-essential libpq-dev curl git --no-install-recommends && rm -rf /var/lib/apt/lists/*

# Copy requirements and install Python dependencies
COPY requirements.txt .
RUN pip install --upgrade pip && pip install -r requirements.txt

# Switch to the vscode user for subsequent commands (optional, but good practice)
USER vscode




# docker-compose down
# docker-compose up --build

#docker-compose restart

# # Stop everything
# docker-compose down -v

# # Clean Docker system
# docker system prune -a --volumes

# # Rebuild and start
# docker-compose up --build -d

# # Run migrations
# docker-compose exec web python manage.py migrate

# # Create superuser
# docker-compose exec web python manage.py createsuperuser

# # Import products
# docker-compose exec web python manage.py import_products